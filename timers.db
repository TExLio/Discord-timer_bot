import aiosqlite
import asyncio

DB_FILE = "timers.db"

async def init_db():
    """Initialize the database and create table if not exists"""
    async with aiosqlite.connect(DB_FILE) as db:
        await db.execute("""
        CREATE TABLE IF NOT EXISTS timers (
            guild_id INTEGER PRIMARY KEY,
            channel_id INTEGER NOT NULL,
            role_id INTEGER NOT NULL
        )
        """)
        await db.commit()
    print("Database initialized!")

async def add_example_servers():
    """Add example servers; edit IDs later"""
    servers = [
        #guild id            channel id          role id
        (123456789012345678, 111111111111111111, 222222222222222222),
        (234567890123456789, 333333333333333333, 444444444444444444),
        (345678901234567890, 555555555555555555, 666666666666666666),
    ]

    async with aiosqlite.connect(DB_FILE) as db:
        for guild_id, channel_id, role_id in servers:
            await db.execute("""
            INSERT INTO timers (guild_id, channel_id, role_id)
            VALUES (?, ?, ?)
            ON CONFLICT(guild_id)
            DO UPDATE SET channel_id=excluded.channel_id, role_id=excluded.role_id
            """, (guild_id, channel_id, role_id))
        await db.commit()
    print("Example servers added! You can edit IDs anytime in the DB.")

# Run the setup
async def main():
    await init_db()
    await add_example_servers()

asyncio.run(main())
